{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/app/agentset/apps/web/src/app/app.agentset.ai/%28dashboard%29/%5Bslug%5D/settings/page.client.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useMemo } from \"react\";\r\nimport { useOrganization } from \"@/contexts/organization-context\";\r\nimport { authClient } from \"@/lib/auth-client\";\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\nimport { useMutation } from \"@tanstack/react-query\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { toast } from \"sonner\";\r\nimport { z } from \"zod\";\r\n\r\nimport {\r\n  Button,\r\n  EntityAvatar,\r\n  Form,\r\n  FormControl,\r\n  FormField,\r\n  FormItem,\r\n  FormLabel,\r\n  FormMessage,\r\n  Input,\r\n} from \"@agentset/ui\";\r\n\r\nconst makeFormSchema = (currentSlug: string) =>\r\n  z.object({\r\n    name: z.string().min(1),\r\n    slug: z\r\n      .string()\r\n      .min(1)\r\n      .regex(/^[a-z0-9]+(?:-[a-z0-9]+)*$/)\r\n      .refine(\r\n        async (value) => {\r\n          if (value === currentSlug) {\r\n            return true;\r\n          }\r\n\r\n          const result = await authClient.organization.checkSlug({\r\n            slug: value,\r\n          });\r\n\r\n          return !!result.data?.status;\r\n        },\r\n        { message: \"Slug is already taken\" },\r\n      ),\r\n  });\r\n\r\nexport default function SettingsPage() {\r\n  const { activeOrganization, setActiveOrganization } = useOrganization();\r\n  const formSchema = useMemo(\r\n    () => makeFormSchema(activeOrganization.slug),\r\n    [activeOrganization.slug],\r\n  );\r\n\r\n  const form = useForm({\r\n    resolver: zodResolver(formSchema),\r\n    defaultValues: {\r\n      name: activeOrganization.name,\r\n      slug: activeOrganization.slug,\r\n    },\r\n  });\r\n\r\n  const { mutateAsync: updateOrganization, isPending } = useMutation({\r\n    mutationFn: async (data: z.infer<typeof formSchema>) => {\r\n      return authClient.organization.update({\r\n        organizationId: activeOrganization.id,\r\n        data: {\r\n          name: data.name,\r\n          slug: data.slug,\r\n        },\r\n      });\r\n    },\r\n    onSuccess: (data) => {\r\n      if (data.data) {\r\n        setActiveOrganization({\r\n          ...activeOrganization,\r\n          name: data.data.name,\r\n          slug: data.data.slug,\r\n        });\r\n      }\r\n      toast.success(\"Organization updated\");\r\n    },\r\n    onError: () => {\r\n      toast.error(\"Failed to update organization\");\r\n    },\r\n  });\r\n\r\n  const onSubmit = (data: z.infer<typeof formSchema>) => {\r\n    void updateOrganization(data);\r\n  };\r\n\r\n  const isDirty = form.formState.isDirty;\r\n\r\n  return (\r\n    <Form {...form}>\r\n      <form\r\n        onSubmit={form.handleSubmit(onSubmit)}\r\n        className=\"flex max-w-md flex-col gap-8\"\r\n      >\r\n        <EntityAvatar\r\n          entity={activeOrganization}\r\n          className=\"size-14\"\r\n          fallbackClassName=\"text-xl\"\r\n        />\r\n\r\n        <FormField\r\n          control={form.control}\r\n          name=\"name\"\r\n          render={({ field }) => (\r\n            <FormItem>\r\n              <FormLabel>Name</FormLabel>\r\n              <FormControl>\r\n                <Input {...field} />\r\n              </FormControl>\r\n              <FormMessage />\r\n            </FormItem>\r\n          )}\r\n        />\r\n\r\n        <FormField\r\n          control={form.control}\r\n          name=\"slug\"\r\n          render={({ field }) => (\r\n            <FormItem>\r\n              <FormLabel>Slug</FormLabel>\r\n              <FormControl>\r\n                <Input {...field} />\r\n              </FormControl>\r\n              <FormMessage />\r\n            </FormItem>\r\n          )}\r\n        />\r\n\r\n        <Button\r\n          type=\"submit\"\r\n          className=\"mt-2 w-fit\"\r\n          disabled={!isDirty}\r\n          isLoading={isPending}\r\n        >\r\n          Save\r\n        </Button>\r\n      </form>\r\n    </Form>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}